<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Formulario Google</title>
</head>
<body>

<h2>Registro</h2>

<form id="googleForm">

<!-- ================= REPRESENTANTE ================= -->
<select name="entry.223399256" required>
  <option value="">Selecciona Representante</option>
  <option value="AGUILAR VARGAS URSULA NOEMI">AGUILAR VARGAS URSULA NOEMI</option>
  <option value="ALTAMIRANO MEGO MARIO SERGIO">ALTAMIRANO MEGO MARIO SERGIO</option>
  <option value="ARBOLEDA SERRATO MEDALITH DEL ROCIO">ARBOLEDA SERRATO MEDALITH DEL ROCIO</option>
  <option value="BALAREZO CASTILLO KEYLA KATHERINE">BALAREZO CASTILLO KEYLA KATHERINE</option>
  <option value="BALLENA FERRE SARA FABIOLA">BALLENA FERRE SARA FABIOLA</option>
  <option value="BECERRA GOMEZ PACO JHORDAN">BECERRA GOMEZ PACO JHORDAN</option>
  <option value="BERRU MENDOZA MARIA ELIZABETH">BERRU MENDOZA MARIA ELIZABETH</option>
  <option value="CARRANZA CHAVESTA JOSE ROMY">CARRANZA CHAVESTA JOSE ROMY</option>
  <option value="CHUNG ESPEJO JUAN FRANCISCO">CHUNG ESPEJO JUAN FRANCISCO</option>
  <option value="CHUNGA PIZARRO MARGARETH ESTEFANI">CHUNGA PIZARRO MARGARETH ESTEFANI</option>
  <option value="ÑIQUEN ARROYO KATTIA LISET">ÑIQUEN ARROYO KATTIA LISET</option>
</select>

<hr>

<!-- ================= TENENCIA ================= -->
<select id="TenenciaPrincipal" name="entry.263067344" required>
  <option value="">Selecciona Tenencia</option>
  <option value="Trio">Trio</option>
  <option value="Duo">Duo</option>
  <option value="Mono">Mono</option>
</select>

<input id="PP_Contenidos" name="entry.2021424275" placeholder="PP_Contenidos" readonly>
<input name="entry.528607190" placeholder="ANI" required>
<input name="entry.938303002" placeholder="Suscripción" required>

<hr>

<!-- ================= RESULTADO ================= -->
<select id="Resultado" name="entry.308640399" required>
  <option value="">Selecciona Resultado</option>
  <option value="CONSULTA">CONSULTA</option>
  <option value="CONTENIDO">CONTENIDO</option>
  <option value="BAJA TOTAL">BAJA TOTAL</option>
  <option value="BAJA PARCIAL">BAJA PARCIAL</option>
</select>

<input id="Contencion" name="entry.1265624613" placeholder="Contención" readonly>

<select name="entry.526710020" required>
  <option value="">Transferencia a isla</option>
  <option value="Si">Si</option>
  <option value="No">No</option>
</select>

<input name="entry.1718642695" placeholder="Folio" required>
<input id="Visualizador" name="entry.448110065" placeholder="Visualizador" readonly>
<input id="Oferta_aplicada" name="entry.461946160" placeholder="Oferta aplicada" readonly>
<input id="Observacion" name="entry.1321924343" placeholder="Observación" readonly>

<hr>

<!-- ================= CAMBIO DE PLAN ================= -->
<input id="RealizasteCambioPlan" name="entry.1187965590" placeholder="Realizaste cambio de plan" readonly>

<select id="Ofreciste" name="entry.435477933" required>
  <option value="">¿Ofreciste?</option>
  <option value="SI">SI</option>
  <option value="NO">NO</option>
  <option value="NO APLICA">NO APLICA</option>
</select>

<input id="MotivoNoOferta" name="entry.217503159" placeholder="Motivo no oferta" readonly>
<input id="Producto" name="entry.795483787" placeholder="Producto" readonly>

<hr>

<button type="submit">Enviar</button>

</form>

<script>
// ================= PP CONTENIDOS =================
function actualizarPP() {
  const t = document.getElementById("TenenciaPrincipal").value;
  const r = document.getElementById("Resultado").value;
  const pp = document.getElementById("PP_Contenidos");

  pp.value = "0";

  if (r === "CONTENIDO") {
    pp.value = (t === "Trio") ? "2" : (t ? "1" : "0");
  }

  if (r === "BAJA PARCIAL" && (t === "Trio" || t === "Duo")) {
    pp.value = "1";
  }
}

document.getElementById("TenenciaPrincipal").addEventListener("change", actualizarPP);
document.getElementById("Resultado").addEventListener("change", actualizarPP);

// ================= RESULTADO =================
document.getElementById("Resultado").addEventListener("change", function () {
  const r = this.value;
  document.getElementById("Contencion").value =
    r === "CONSULTA" ? "NO APLICA" :
    r === "BAJA TOTAL" ? "NO" : "SI";

  document.getElementById("Visualizador").value =
    (r === "CONTENIDO") ? "SI" :
    (r === "BAJA PARCIAL") ? "ARGUMENTARIO" : "NO APLICA";

  document.getElementById("RealizasteCambioPlan").value =
    (r === "CONTENIDO") ? "MIGRA" :
    (r === "BAJA PARCIAL") ? "BAJA PARCIAL" : "NO APLICA";
});

// ================= VISUALIZADOR =================
document.getElementById("Visualizador").addEventListener("change", function () {
  const v = this.value;
  document.getElementById("Oferta_aplicada").value =
    v === "SI" ? "OFERTA APLICADA" :
    v === "ARGUMENTARIO" ? "ARGUMENTARIO" : "NO APLICA";

  document.getElementById("Observacion").value =
    v === "SI" ? "CLIENTE CONFORME" :
    v === "ARGUMENTARIO" ? "SE UTILIZA ARGUMENTARIO" : "NO APLICA";
});

// ================= OFRECISTE =================
document.getElementById("Ofreciste").addEventListener("change", function () {
  const v = this.value;
  document.getElementById("MotivoNoOferta").value =
    v === "NO" ? "CLIENTE" : "NO APLICA";

  document.getElementById("Producto").value =
    v === "SI" ? "FIBRA / MOVIL" : "NO APLICA";
});

// ================= ENVIO =================
document.getElementById("googleForm").addEventListener("submit", function(e) {
  e.preventDefault();
  fetch(
    "https://docs.google.com/forms/d/1Mlds1RQPtTiL2oqL0dtmKdilH2Y2X57KW1V3ADudOa8/formResponse",
    { method: "POST", mode: "no-cors", body: new FormData(this) }
  );
  alert("Datos enviados correctamente");
  this.reset();
});
</script>

</body>
</html>
