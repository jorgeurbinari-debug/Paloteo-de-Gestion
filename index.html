<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Formulario Google</title>

<style>
body{
  font-family: Arial, Helvetica, sans-serif;
  background:#f4f6f8;
  margin:0;
  padding:30px;
}
h2{ text-align:center; margin-bottom:25px; }

form{
  max-width:1200px;
  margin:auto;
  background:white;
  padding:30px;
  border-radius:10px;
  box-shadow:0 10px 25px rgba(0,0,0,0.1);
}

.grid{
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap:20px;
}

.campo{ display:flex; flex-direction:column; }

.campo label{
  font-size:13px;
  font-weight:bold;
  margin-bottom:6px;
}

.campo input,
.campo select{
  padding:10px;
  border-radius:6px;
  border:1px solid #ccc;
  font-size:14px;
}

.campo input:focus,
.campo select:focus{
  border-color:#007bff;
  outline:none;
  box-shadow:0 0 0 2px rgba(0,123,255,0.2);
}

button{
  margin-top:25px;
  padding:12px;
  width:100%;
  border:none;
  border-radius:6px;
  background:#007bff;
  color:white;
  font-size:16px;
  cursor:pointer;
}
button:hover{ background:#0056b3; }

.error{ border:2px solid red !important; }
.full{ grid-column: span 3; }
</style>
</head>

<body>

<h2>Registro</h2>

<form id="googleForm">
<div class="grid">

<div class="campo">
<label>Representante *</label>
<select name="entry.223399256" required>
<option value="">Selecciona Representante</option>
<option value="AGUILAR VARGAS URSULA NOEMI">AGUILAR VARGAS URSULA NOEMI</option>
<option value="ALTAMIRANO MEGO MARIO SERGIO">ALTAMIRANO MEGO MARIO SERGIO</option>
<option value="ARBOLEDA SERRATO MEDALITH DEL ROCIO">ARBOLEDA SERRATO MEDALITH DEL ROCIO</option>
<option value="ÑIQUEN ARROYO KATTIA LISET">ÑIQUEN ARROYO KATTIA LISET</option>
</select>
</div>

<div class="campo">
<label>Tenencia *</label>
<select id="Tenencia" name="entry.263067344" required>
<option value="">Selecciona</option>
<option value="Trio">Trio</option>
<option value="Duo">Duo</option>
<option value="Mono">Mono</option>
</select>
</div>

<div class="campo">
<label>PP Contenidos *</label>
<input id="PP_Contenidos" name="entry.2021424275" readonly required>
</div>

<div class="campo">
<label>ANI *</label>
<input name="entry.528607190" required>
</div>

<div class="campo">
<label>Suscripción *</label>
<input name="entry.938303002" required>
</div>

<div class="campo">
<label>Resultado *</label>
<select id="Resultado" name="entry.308640399" required>
<option value="">Selecciona</option>
<option value="CONSULTA">CONSULTA</option>
<option value="CONTENIDO">CONTENIDO</option>
<option value="BAJA TOTAL">BAJA TOTAL</option>
<option value="BAJA PARCIAL">BAJA PARCIAL</option>
</select>
</div>

<div class="campo">
<label>Contención *</label>
<select id="Contencion" name="entry.1265624613" required></select>
</div>

<div class="campo">
<label>Trans. Isla *</label>
<select id="TenenciaValidacion" name="entry.526710020" required>
<option value="">Selecciona</option>
<option value="Si">Si</option>
<option value="No">No</option>
</select>
</div>

<div class="campo">
<label>Folio *</label>
<input name="entry.1718642695" required>
</div>

<div class="campo">
<label>Visualizador *</label>
<select id="Visualizador" name="entry.448110065" required></select>
</div>

<div class="campo">
<label>Oferta Aplicada *</label>
<select id="Oferta_aplicada" name="entry.461946160" required></select>
</div>

<div class="campo full">
<label>Observación de No Adhiere *</label>
<select id="Observacion" name="entry.1321924343" required></select>
</div>

<div class="campo">
<label>Migra *</label>
<select id="Realizaste_Cambio_de_Plan" name="entry.1187965590" required></select>
</div>

<div class="campo">
<label>Ofreciste *</label>
<select id="Ofreciste" name="entry.435477933" required>
<option value="">Selecciona</option>
<option value="SI">Si</option>
<option value="NO">No</option>
<option value="NO APLICA">No Aplica</option>
</select>
</div>

<div class="campo">
<label>Motivo No Oferta *</label>
<select id="Motivo_no_oferta" name="entry.217503159" required></select>
</div>

<div class="campo">
<label>Producto Ofrecido *</label>
<select id="Producto" name="entry.795483787" required></select>
</div>

<div class="campo">
<label>Motivo Baja *</label>
<select id="Motivo_baja" name="entry.960725776" required>
<option value="">Selecciona</option>
<option value="Competencia con mejor precio">Competencia con mejor precio</option>
<option value="Falla masiva">Falla masiva</option>
<option value="Fallecimiento">Fallecimiento</option>
<option value="Mala experiencia Técnica">Mala experiencia Técnica</option>
<option value="No entrega información">No entrega información</option>
<option value="No hay factibilidad">No hay factibilidad</option>
<option value="No reconoce venta">No reconoce venta</option>
<option value="Oferta no aplicada">Oferta no aplicada</option>
<option value="Reclamo ajuste IPC">Reclamo ajuste IPC</option>
<option value="Reclamos Facturación">Reclamos Facturación</option>
<option value="Renovación descuento">Renovación descuento</option>
<option value="Situacion económica">Situacion económica</option>
<option value="Sustituye por producto Movistar">Sustituye por producto Movistar</option>
<option value="Traslado">Traslado</option>
<option value="NO APLICA">NO APLICA</option>
</select>
</div>

<div class="campo">
<label>Oferta Máxima *</label>
<select id="Oferta_maxima" name="entry.1087208625" required>
<option value="">Selecciona</option>
<option value="OFERTA DEL 20">OFERTA DEL 20</option>
<option value="OFERTA DEL 21">OFERTA DEL 21</option>
<option value="ARGUMENTARIO">ARGUMENTARIO</option>
<option value="NO APLICA">NO APLICA</option>
</select>
</div>

</div>

<button type="submit">Enviar</button>
</form>

<script>
// ========= TU LÓGICA ORIGINAL + VALIDACIÓN =========
function setOptions(select, options) {
  select.innerHTML = "";
  const placeholder = document.createElement("option");
  placeholder.value = "";
  placeholder.textContent = "Selecciona";
  select.appendChild(placeholder);
  options.forEach(opt => {
    const option = document.createElement("option");
    option.value = opt;
    option.textContent = opt;
    select.appendChild(option);
  });
}

const Resultado = document.getElementById("Resultado");
const Tenencia = document.getElementById("Tenencia");
const PP_Contenidos = document.getElementById("PP_Contenidos");
const Visualizador = document.getElementById("Visualizador");
const Oferta_aplicada = document.getElementById("Oferta_aplicada");
const Observacion = document.getElementById("Observacion");
const Realizaste_Cambio_de_Plan = document.getElementById("Realizaste_Cambio_de_Plan");
const Ofreciste = document.getElementById("Ofreciste");
const Motivo_no_oferta = document.getElementById("Motivo_no_oferta");
const Producto = document.getElementById("Producto");
const Contencion = document.getElementById("Contencion");

// PP Contenidos
function actualizarPPContenidos() {
  const t = Tenencia.value;
  const r = Resultado.value;
  if (!t || !r) { PP_Contenidos.value = "0"; return; }
  if (r === "CONTENIDO") PP_Contenidos.value = (t === "Trio") ? "2" : "1";
  else if (r === "BAJA PARCIAL") PP_Contenidos.value = (t === "Trio" || t === "Duo") ? "1" : "0";
  else PP_Contenidos.value = "0";
}
Tenencia.addEventListener("change", actualizarPPContenidos);
Resultado.addEventListener("change", actualizarPPContenidos);

// Resultado dinámico
Resultado.addEventListener("change", function() {
  const val = this.value.toUpperCase();
  if (["CONSULTA","BAJA TOTAL"].includes(val)) setOptions(Visualizador, ["NO APLICA"]);
  else if (["CONTENIDO","BAJA PARCIAL"].includes(val)) setOptions(Visualizador, ["SI","NO","Argumentario"]);
  else setOptions(Visualizador, []);

  if (val === "CONSULTA") setOptions(Contencion, ["NO APLICA (Solo consultas)"]);
  else if (["CONTENIDO","BAJA PARCIAL"].includes(val)) setOptions(Contencion, ["SI"]);
  else if (val === "BAJA TOTAL") setOptions(Contencion, ["NO"]);
  else setOptions(Contencion, []);

  if (["BAJA TOTAL","CONSULTA"].includes(val)) setOptions(Realizaste_Cambio_de_Plan, ["NO APLICA"]);
  else if (val === "CONTENIDO") setOptions(Realizaste_Cambio_de_Plan, ["MIGRA DOWN","MIGRA UP","NO APLICA"]);
  else if (val === "BAJA PARCIAL") setOptions(Realizaste_Cambio_de_Plan, ["BAJA PARCIAL"]);
  else setOptions(Realizaste_Cambio_de_Plan, []);
});

// Visualizador
Visualizador.addEventListener("change", function() {
  const val = this.value.toUpperCase();
  if (val === "SI") setOptions(Oferta_aplicada, ["OFERTA 1","OFERTA 2","OFERTA 3"]);
  else if (val === "NO") setOptions(Oferta_aplicada, ["OFERTA NO ADHERIDA"]);
  else if (val === "ARGUMENTARIO") setOptions(Oferta_aplicada, ["ARGUMENTARIO"]);
  else setOptions(Oferta_aplicada, []);
});

// Observación
Oferta_aplicada.addEventListener("change", function() {
  const val = this.value.toUpperCase();
  if (["OFERTA 1","OFERTA 2","OFERTA 3"].includes(val))
    setOptions(Observacion, ["CLIENTE CONFORME CON OFERTA DE VISUALIZADOR"]);
  else if (val === "ARGUMENTARIO")
    setOptions(Observacion, ["ARGUMENTARIO"]);
  else if (val === "OFERTA NO ADHERIDA")
    setOptions(Observacion, [
      "RETE - OFERTA NO SE ADAPTA A NECESIDAD DEL CLIENTE",
      "N2 - OFERTA NO SE ADAPTA A NECESIDAD DEL CLIENTE",
      "SOLICITA LA OFERTA MAS AGRESIVA",
      "OFERTADOR NO ARROJA OPCIONES"
    ]);
  else setOptions(Observacion, []);
});

// Ofreciste
Ofreciste.addEventListener("change", function() {
  const val = this.value.toUpperCase();
  if (val === "SI") {
    setOptions(Motivo_no_oferta, ["NO APLICA"]);
    setOptions(Producto, ["FIBRA","ALTA MÓVIL","PORTABILIDAD MÓVIL","FIBRA + MÓVIL","RECAMBIO","FIBRA + RECAMBIO","MOVIL + RECAMBIO"]);
  } else if (val === "NO") {
    setOptions(Motivo_no_oferta, ["CLIENTE","VMO","EXPERIENCIA ANTERIOR"]);
    setOptions(Producto, ["NO APLICA"]);
  } else {
    setOptions(Motivo_no_oferta, ["NO APLICA"]);
    setOptions(Producto, ["NO APLICA"]);
  }
});

// Validación + envío
document.getElementById("googleForm").addEventListener("submit", function(e) {
  e.preventDefault();
  let valido = true;
  this.querySelectorAll("select, input").forEach(campo => {
    campo.classList.remove("error");
    if (!campo.value) {
      campo.classList.add("error");
      valido = false;
    }
  });
  if (!valido) {
    alert("Debes completar TODOS los campos obligatorios");
    return;
  }

  const formData = new FormData(this);
  fetch("https://docs.google.com/forms/d/1Mlds1RQPtTiL2oqL0dtmKdilH2Y2X57KW1V3ADudOa8/formResponse", {
    method: "POST",
    mode: "no-cors",
    body: formData
  });

  alert("Datos enviados correctamente");
  this.reset();
});
</script>

</body>
</html>


