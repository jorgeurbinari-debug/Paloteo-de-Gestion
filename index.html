<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Formulario Google</title>
  <!-- Librer铆a para leer bien el CSV de Google -->
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>


<style>
body{
  font-family: Arial, Helvetica, sans-serif;
  background:#f4f6f8;
  margin:0;
  padding:30px;
}
h2{ text-align:center; margin-bottom:25px; }

form{
  max-width:1200px;
  margin:auto;
  background:white;
  padding:30px;
  border-radius:10px;
  box-shadow:0 10px 25px rgba(0,0,0,0.1);
}

.grid{
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap:20px;
}

.campo{ display:flex; flex-direction:column; }

.campo label{
  font-size:13px;
  font-weight:bold;
  margin-bottom:6px;
}

.campo input,
.campo select{
  padding:10px;
  border-radius:6px;
  border:1px solid #ccc;
  font-size:14px;
}

.campo input:focus,
.campo select:focus{
  border-color:#007bff;
  outline:none;
  box-shadow:0 0 0 2px rgba(0,123,255,0.2);
}

button{
  margin-top:25px;
  padding:12px;
  width:100%;
  border:none;
  border-radius:6px;
  background:#007bff;
  color:white;
  font-size:16px;
  cursor:pointer;
}
button:hover{ background:#0056b3; }

.error{ border:2px solid red !important; }
.full{ grid-column: span 3; }
</style>
</head>

<body>

<h2>Registro</h2>

<form id="googleForm">
<div class="grid">

<div class="campo">
<label>Representante *</label>
<select name="entry.223399256" required>
<option value="">Selecciona Representante</option>
    <option value="AGUILAR VARGAS URSULA NOEMI">AGUILAR VARGAS URSULA NOEMI</option>
    <option value="ALTAMIRANO MEGO MARIO SERGIO">ALTAMIRANO MEGO MARIO SERGIO</option>
    <option value="ARBOLEDA SERRATO MEDALITH DEL ROCIO">ARBOLEDA SERRATO MEDALITH DEL ROCIO</option>
    <option value="BALAREZO CASTILLO KEYLA KATHERINE">BALAREZO CASTILLO KEYLA KATHERINE</option>
    <option value="BALLENA FERRE SARA FABIOLA">BALLENA FERRE SARA FABIOLA</option>
    <option value="BECERRA GOMEZ PACO JHORDAN">BECERRA GOMEZ PACO JHORDAN</option>
    <option value="BERRU MENDOZA MARIA ELIZABETH">BERRU MENDOZA MARIA ELIZABETH</option>
    <option value="CARRANZA CHAVESTA JOSE ROMY">CARRANZA CHAVESTA JOSE ROMY</option>
    <option value="CHUNG ESPEJO JUAN FRANCISCO">CHUNG ESPEJO JUAN FRANCISCO</option>
    <option value="CHUNGA PIZARRO MARGARETH ESTEFANI">CHUNGA PIZARRO MARGARETH ESTEFANI</option>
    <option value="CRISANTO GARRIDO DEYSI MARIBEL">CRISANTO GARRIDO DEYSI MARIBEL</option>
    <option value="CRISANTO LARTIGA MARIA VANESSA">CRISANTO LARTIGA MARIA VANESSA</option>
    <option value="DELGADO FARRO MITZY YOSHELY">DELGADO FARRO MITZY YOSHELY</option>
    <option value="DIAZ ACUA PAOLA STEFANIE">DIAZ ACUA PAOLA STEFANIE</option>
    <option value="DIAZ QUIROZ JOSE GALENO">DIAZ QUIROZ JOSE GALENO</option>
    <option value="ESPINOZA SILVA KIMBERLY YAMILE">ESPINOZA SILVA KIMBERLY YAMILE</option>
    <option value="FLORES NAVAL JUANA DEL PILAR">FLORES NAVAL JUANA DEL PILAR</option>
    <option value="GORDILLO YAIPEN EDITH MADELEI">GORDILLO YAIPEN EDITH MADELEI</option>
    <option value="GONZALES SAENZ EDGARDO DAVID">GONZALES SAENZ EDGARDO DAVID</option>
    <option value="GUTIERREZ MENDOZA TERESA OCDULIA">GUTIERREZ MENDOZA TERESA OCDULIA</option>
    <option value="HORNA CARRERO LILIANA">HORNA CARRERO LILIANA</option>
    <option value="LARIOS FIESTAS YESENIA PAOLA">LARIOS FIESTAS YESENIA PAOLA</option>
    <option value="LUCERO COTRINA JAIME ENRIQUE">LUCERO COTRINA JAIME ENRIQUE</option>
    <option value="LUNA TERRONES MIRIAN ROCIO">LUNA TERRONES MIRIAN ROCIO</option>
    <option value="MANAYAY ABAZALO BEVERLY BEATRIZ">MANAYAY ABAZALO BEVERLY BEATRIZ</option>
    <option value="MASABEL RIVAS GUILLERMINA DEL ROSARIO">MASABEL RIVAS GUILLERMINA DEL ROSARIO</option>
    <option value="MELENDEZ DEL CASTILLO FERNANDO GABRIEL">MELENDEZ DEL CASTILLO FERNANDO GABRIEL</option>
    <option value="ORTIZ SALAZAR ANABELEN">ORTIZ SALAZAR ANABELEN</option>
    <option value="PEREZ BANCES EDUARDO XKANLEONX ROLANDO">PEREZ BANCES EDUARDO XKANLEONX ROLANDO</option>
    <option value="PEREZ GONZALES KATHERINE YESSENIA">PEREZ GONZALES KATHERINE YESSENIA</option>
    <option value="RIOJAS TERRONES ANGELLA LIZETH">RIOJAS TERRONES ANGELLA LIZETH</option>
    <option value="RIVERA MERA JESSICA KARINA">RIVERA MERA JESSICA KARINA</option>
    <option value="SALAZAR VASQUEZ ANTONI MIGUEL">SALAZAR VASQUEZ ANTONI MIGUEL</option>
    <option value="SANCHEZ VILLAFRANQUI STEPHANO MIGUEL">SANCHEZ VILLAFRANQUI STEPHANO MIGUEL</option>
    <option value="SIRLUPU YOVERA AMALIA MARGOT">SIRLUPU YOVERA AMALIA MARGOT</option>
    <option value="SOTELO CHUMBE ABENCIA">SOTELO CHUMBE ABENCIA</option>
    <option value="TORRES OLANO PIERO ALEJANDRO">TORRES OLANO PIERO ALEJANDRO</option>
    <option value="TRIGOSO AYALA LISET MABEL">TRIGOSO AYALA LISET MABEL</option>
    <option value="UGAZ SAAVEDRA TIFFANY BRICET">UGAZ SAAVEDRA TIFFANY BRICET</option>
    <option value="VALDERRAMA CAJO FABIOLA KATHERINE MILAGROS DEL SOL">VALDERRAMA CAJO FABIOLA KATHERINE MILAGROS DEL SOL</option>
    <option value="VELASQUEZ SENMACHE MIGUEL ANGEL">VELASQUEZ SENMACHE MIGUEL ANGEL</option>
    <option value="VELASQUEZ FRIAS LIZBETH KARELLY">VELASQUEZ FRIAS LIZBETH KARELLY</option>
    <option value="VELIZ CHOQUE JANETH JHOSELIE">VELIZ CHOQUE JANETH JHOSELIE</option>
    <option value="IQUEN ARROYO KATTIA LISET">IQUEN ARROYO KATTIA LISET</option>
  <option value="SANTISTEVAN DE LOS SANTOS DAHYANA MAGALI">SANTISTEVAN DE LOS SANTOS DAHYANA MAGALI</option>
  <option value="HUERTAS CORREA MARIA DE LOS ANGELES">HUERTAS CORREA MARIA DE LOS ANGELES</option>
  <option value="SOTO CORREA SANDRA ELIZABETH">SOTO CORREA SANDRA ELIZABETH</option>

</select>
</div>

<div class="campo">
<label>Tenencia *</label>
<select id="Tenencia" name="entry.263067344" required>
<option value="">Selecciona</option>
<option value="Trio">Trio</option>
<option value="Duo">Duo</option>
<option value="Mono">Mono</option>
</select>
</div>

<div class="campo">
<label>PP Contenidos *</label>
<input id="PP_Contenidos" name="entry.2021424275" readonly required>
</div>

<div class="campo">
<label>ANI *</label>
<input name="entry.528607190" required>
</div>

<div class="campo">
<label>Suscripci贸n *</label>
<input name="entry.938303002" required>
</div>

<div class="campo">
<label>Resultado *</label>
<select id="Resultado" name="entry.308640399" required>
<option value="">Selecciona</option>
<option value="CONSULTA">CONSULTA</option>
<option value="CONTENIDO">CONTENIDO</option>
<option value="BAJA TOTAL">BAJA TOTAL</option>
<option value="BAJA PARCIAL">BAJA PARCIAL</option>
</select>
</div>

<div class="campo">
<label>Contenci贸n *</label>
<select id="Contencion" name="entry.1265624613" required></select>
</div>

<div class="campo">
<label>Trans. Isla *</label>
<select id="TenenciaValidacion" name="entry.526710020" required>
<option value="">Selecciona</option>
<option value="Si">Si</option>
<option value="No">No</option>
</select>
</div>

<div class="campo">
<label>Folio *</label>
<input name="entry.1718642695" required>
</div>

<div class="campo">
<label>Visualizador *</label>
<select id="Visualizador" name="entry.448110065" required></select>
</div>

<div class="campo">
<label>Oferta Aplicada *</label>
<select id="Oferta_aplicada" name="entry.461946160" required></select>
</div>

<div class="campo full">
<label>Observaci贸n de No Adhiere *</label>
<select id="Observacion" name="entry.1321924343" required></select>
</div>

<div class="campo">
<label>Migra *</label>
<select id="Realizaste_Cambio_de_Plan" name="entry.1187965590" required></select>
</div>

<div class="campo">
<label>Ofreciste *</label>
<select id="Ofreciste" name="entry.435477933" required>
<option value="">Selecciona</option>
<option value="SI">Si</option>
<option value="NO">No</option>
<option value="NO APLICA">No Aplica</option>
</select>
</div>

<div class="campo">
<label>Motivo No Oferta *</label>
<select id="Motivo_no_oferta" name="entry.217503159" required></select>
</div>

<div class="campo">
<label>Producto Ofrecido *</label>
<select id="Producto" name="entry.795483787" required></select>
</div>

<div class="campo">
<label>Motivo Baja *</label>
<select id="Motivo_baja" name="entry.960725776" required>
<option value="">Selecciona</option>
<option value="Competencia con mejor precio">Competencia con mejor precio</option>
<option value="Falla masiva">Falla masiva</option>
<option value="Fallecimiento">Fallecimiento</option>
<option value="Mala experiencia T茅cnica">Mala experiencia T茅cnica</option>
<option value="No entrega informaci贸n">No entrega informaci贸n</option>
<option value="No hay factibilidad">No hay factibilidad</option>
<option value="No reconoce venta">No reconoce venta</option>
<option value="Oferta no aplicada">Oferta no aplicada</option>
<option value="Reclamo ajuste IPC">Reclamo ajuste IPC</option>
<option value="Reclamos Facturaci贸n">Reclamos Facturaci贸n</option>
<option value="Renovaci贸n descuento">Renovaci贸n descuento</option>
<option value="Situacion econ贸mica">Situacion econ贸mica</option>
<option value="Sustituye por producto Movistar">Sustituye por producto Movistar</option>
<option value="Traslado">Traslado</option>
<option value="NO APLICA">NO APLICA</option>
</select>
</div>

<div class="campo">
<label>Oferta M谩xima *</label>
<select id="Oferta_maxima" name="entry.1087208625" required>
<option value="">Selecciona</option>
    <option value="OFERTA DEL 20">OFERTA DEL 20</option>
    <option value="OFERTA DEL 21">OFERTA DEL 21 </option>
    <option value="OFERTA DEL 22">OFERTA DEL 22 </option>
    <option value="OFERTA DEL 23">OFERTA DEL 23 </option>
    <option value="OFERTA DEL 24">OFERTA DEL 24 </option>
    <option value="OFERTA DEL 25">OFERTA DEL 25 </option>
    <option value="OFERTA DEL 26">OFERTA DEL 26 </option>
    <option value="OFERTA DEL 27">OFERTA DEL 27 </option>
    <option value="OFERTA DEL 28">OFERTA DEL 28 </option>
    <option value="OFERTA DEL 29">OFERTA DEL 29 </option>
    <option value="OFERTA DEL 30">OFERTA DEL 30 </option>
    <option value="OFERTA DEL 31">OFERTA DEL 31 </option>
    <option value="OFERTA DEL 32">OFERTA DEL 32 </option>
    <option value="OFERTA DEL 33">OFERTA DEL 33 </option>
    <option value="OFERTA DEL 34">OFERTA DEL 34 </option>
    <option value="OFERTA DEL 35">OFERTA DEL 35 </option>
    <option value="OFERTA DEL 36">OFERTA DEL 36 </option>
    <option value="OFERTA DEL 37">OFERTA DEL 37 </option>
    <option value="OFERTA DEL 38">OFERTA DEL 38 </option>
    <option value="OFERTA DEL 39">OFERTA DEL 39 </option>
    <option value="OFERTA DEL 40">OFERTA DEL 40 </option>
    <option value="OFERTA DEL 41">OFERTA DEL 41 </option>
    <option value="OFERTA DEL 42">OFERTA DEL 42 </option>
    <option value="OFERTA DEL 43">OFERTA DEL 43 </option>
    <option value="OFERTA DEL 44">OFERTA DEL 44 </option>
    <option value="OFERTA DEL 45">OFERTA DEL 45 </option>
    <option value="OFERTA DEL 46">OFERTA DEL 46 </option>
    <option value="OFERTA DEL 47">OFERTA DEL 47 </option>
    <option value="OFERTA DEL 48">OFERTA DEL 48 </option>
    <option value="OFERTA DEL 49">OFERTA DEL 49 </option>
    <option value="OFERTA DEL 50">OFERTA DEL 50 </option>
    <option value="ARGUMENTARIO">ARGUMENTARIO </option>
    <option value="NO APLICA">NO APLICA </option>
</select>
</div>

</div>

<button type="submit">Enviar</button>
  
<div id="panelResumen" style="margin-top:20px; padding:15px; border:1px solid #ccc; border-radius:8px;">
  <h3>Resumen del Representante</h3>
  <div id="resumenContenido">Sin datos a煤n...</div>
</div>

  
</form>

<script>
// ========= TU LGICA ORIGINAL + VALIDACIN =========
function setOptions(select, options) {
  select.innerHTML = "";
  const placeholder = document.createElement("option");
  placeholder.value = "";
  placeholder.textContent = "Selecciona";
  select.appendChild(placeholder);
  options.forEach(opt => {
    const option = document.createElement("option");
    option.value = opt;
    option.textContent = opt;
    select.appendChild(option);
  });
}

const Resultado = document.getElementById("Resultado");
const Tenencia = document.getElementById("Tenencia");
const PP_Contenidos = document.getElementById("PP_Contenidos");
const Visualizador = document.getElementById("Visualizador");
const Oferta_aplicada = document.getElementById("Oferta_aplicada");
const Observacion = document.getElementById("Observacion");
const Realizaste_Cambio_de_Plan = document.getElementById("Realizaste_Cambio_de_Plan");
const Ofreciste = document.getElementById("Ofreciste");
const Motivo_no_oferta = document.getElementById("Motivo_no_oferta");
const Producto = document.getElementById("Producto");
const Contencion = document.getElementById("Contencion");

//Cuando cambias el representante, carga el resumen autom谩ticamente
document.querySelector('select[name="entry.223399256"]')
  .addEventListener("change", function () {
    if (this.value) {
      cargarResumenRepresentante(this.value);
    }
  });


// PP Contenidos
function actualizarPPContenidos() {
  const t = Tenencia.value;
  const r = Resultado.value;
  if (!t || !r) { PP_Contenidos.value = "0"; return; }
  if (r === "CONTENIDO") PP_Contenidos.value = (t === "Trio") ? "2" : "1";
  else if (r === "BAJA PARCIAL") PP_Contenidos.value = (t === "Trio" || t === "Duo") ? "1" : "0";
  else PP_Contenidos.value = "0";
}
Tenencia.addEventListener("change", actualizarPPContenidos);
Resultado.addEventListener("change", actualizarPPContenidos);

// Resultado din谩mico
Resultado.addEventListener("change", function() {
  const val = this.value.toUpperCase();
  if (["CONSULTA","BAJA TOTAL"].includes(val)) setOptions(Visualizador, ["NO APLICA"]);
  else if (["CONTENIDO","BAJA PARCIAL"].includes(val)) setOptions(Visualizador, ["SI","NO","Argumentario"]);
  else setOptions(Visualizador, []);

  if (val === "CONSULTA") setOptions(Contencion, ["NO APLICA (Solo consultas)"]);
  else if (["CONTENIDO","BAJA PARCIAL"].includes(val)) setOptions(Contencion, ["SI"]);
  else if (val === "BAJA TOTAL") setOptions(Contencion, ["NO"]);
  else setOptions(Contencion, []);

  if (["BAJA TOTAL","CONSULTA"].includes(val)) setOptions(Realizaste_Cambio_de_Plan, ["NO APLICA"]);
  else if (val === "CONTENIDO") setOptions(Realizaste_Cambio_de_Plan, ["MIGRA DOWN","MIGRA UP","ALOCACION","NO APLICA"]);
  else if (val === "BAJA PARCIAL") setOptions(Realizaste_Cambio_de_Plan, ["BAJA PARCIAL"]);
  else setOptions(Realizaste_Cambio_de_Plan, []);
});

// Visualizador
Visualizador.addEventListener("change", function() {
  const val = this.value.toUpperCase();
  if (val === "SI") setOptions(Oferta_aplicada, ["OFERTA 1","OFERTA 2","OFERTA 3"]);
  else if (val === "NO") setOptions(Oferta_aplicada, ["OFERTA NO ADHERIDA"]);
  else if (val === "ARGUMENTARIO") setOptions(Oferta_aplicada, ["ARGUMENTARIO"]);
  else setOptions(Oferta_aplicada, ["NO APLICA"]);
});

// Observaci贸n
Oferta_aplicada.addEventListener("change", function() {
  const val = this.value.toUpperCase();
  if (["OFERTA 1","OFERTA 2","OFERTA 3"].includes(val))
    setOptions(Observacion, ["CLIENTE CONFORME CON OFERTA DE VISUALIZADOR"]);
  else if (val === "ARGUMENTARIO")
    setOptions(Observacion, ["ARGUMENTARIO"]);
  else if (val === "OFERTA NO ADHERIDA")
    setOptions(Observacion, [
      "RETE - OFERTA NO SE ADAPTA A NECESIDAD DEL CLIENTE",
      "N2 - OFERTA NO SE ADAPTA A NECESIDAD DEL CLIENTE",
      "SOLICITA LA OFERTA MAS AGRESIVA",
      "OFERTADOR NO ARROJA OPCIONES"
    ]);
  else setOptions(Observacion, ["NO APLICA"]);
});

// Ofreciste
Ofreciste.addEventListener("change", function() {
  const val = this.value.toUpperCase();
  if (val === "SI") {
    setOptions(Motivo_no_oferta, ["NO APLICA"]);
    setOptions(Producto, ["FIBRA","ALTA MVIL","PORTABILIDAD MVIL","FIBRA + MVIL","RECAMBIO","FIBRA + RECAMBIO","MOVIL + RECAMBIO"]);
  } else if (val === "NO") {
    setOptions(Motivo_no_oferta, ["CLIENTE","VMO","EXPERIENCIA ANTERIOR"]);
    setOptions(Producto, ["NO APLICA"]);
  } else {
    setOptions(Motivo_no_oferta, ["NO APLICA"]);
    setOptions(Producto, ["NO APLICA"]);
  }
});
// nuevo pegado
async function cargarResumenRepresentante(nombreRep) {
  const urlCSV = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRUiLLFSDvgj2HRQjmt9OWRmUbOjR1gsWJI8777eIJwEavDZyLmn57lNG2bdqNG7EE21rWhji3iEpNw/pub?output=csv";

  const response = await fetch(urlCSV);
  const csvText = await response.text();

  const resultado = Papa.parse(csvText, {
    header: true,
    skipEmptyLines: true
  });

  const datos = resultado.data;

  const filasRep = datos.filter(f =>
    (f["REPRESENTANTE"] || "").trim().toUpperCase() === nombreRep.trim().toUpperCase()
  );

  if (filasRep.length === 0) {
    document.getElementById("resumenContenido").innerHTML =
      "No hay registros para este representante.";
    return;
  }

  function sumar(col) {
    return filasRep.reduce((acc, f) => acc + (parseInt(f[col]) || 0), 0);
  }

  document.getElementById("resumenContenido").innerHTML = `
    <p><b>Registros:</b> ${filasRep.length}</p>
    <p><b>Q ATENDIDAS:</b> ${sumar("Q ATENDIDAS")}</p>
    <p><b>Q CASOS:</b> ${sumar("Q CASOS")}</p>
    <p><b>Q TRANSFERENCIAS ISLA:</b> ${sumar("Q TRANSFERENCIAS ISLA")}</p>
    <p><b>Q CONTENIDOS FO:</b> ${sumar("Q CONTENIDOS FO")}</p>
    <p><b>Q NO CONTENIDOS FO:</b> ${sumar("Q NO CONTENIDOS FO")}</p>
    <p><b>OFERTAS APLICADAS:</b> ${sumar("Q DE OFERTAS APLICADAS")}</p>
    <p><b>ARGUMENTARIOS:</b> ${sumar("Q DE ARGUMENTARIOS")}</p>
  `;
}


  
// Validaci贸n + env铆o
document.getElementById("googleForm").addEventListener("submit", async function(e) {

  e.preventDefault();

  let valido = true;
  this.querySelectorAll("select, input").forEach(campo => {
    campo.classList.remove("error");
    if (!campo.value) {
      campo.classList.add("error");
      valido = false;
    }
  });

  if (!valido) {
    alert("Debes completar TODOS los campos obligatorios");
    return;
  }

  // ================== FORM 1 (el que ya usas) ==================
 
document.getElementById("googleForm").addEventListener("submit", async function(e) {
  e.preventDefault(); //  FALTABA ESTO

  // ================== FORM 1 ==================
  const formData1 = new FormData(this);

  // ================== FORM 2 ==================
  const formData2 = new FormData();

  // Mapeo exacto campo por campo
  formData2.set("entry.492315650", formData1.get("entry.223399256")); // Representante
  formData2.set("entry.1231747244", formData1.get("entry.263067344")); // Tenencia
  formData2.set("entry.459211310", formData1.get("entry.2021424275")); // PP Contenidos
  formData2.set("entry.1964130523", formData1.get("entry.528607190")); // ANI
  formData2.set("entry.482337000", formData1.get("entry.938303002")); // Suscripci贸n
  formData2.set("entry.642025137", formData1.get("entry.308640399")); // Resultado
  formData2.set("entry.1990652723", formData1.get("entry.1265624613")); // Contenci贸n
  formData2.set("entry.1481086183", formData1.get("entry.526710020")); // Trans Isla
  formData2.set("entry.257593832", formData1.get("entry.1718642695")); // Folio
  formData2.set("entry.1892522086", formData1.get("entry.448110065")); // Visualizador
  formData2.set("entry.728954034", formData1.get("entry.461946160")); // Oferta Aplicada
  formData2.set("entry.1965024523", formData1.get("entry.1321924343")); // Observaci贸n
  formData2.set("entry.1126405093", formData1.get("entry.1187965590")); // Migra
  formData2.set("entry.1388418047", formData1.get("entry.435477933")); // Ofreciste
  formData2.set("entry.1986891665", formData1.get("entry.217503159")); // Motivo No Oferta
  formData2.set("entry.301914441", formData1.get("entry.795483787")); // Producto
  formData2.set("entry.1577832641", formData1.get("entry.960725776")); // Motivo Baja
  formData2.set("entry.669962419", formData1.get("entry.1087208625")); // Oferta M谩xima

  // Mensaje visual
  document.getElementById("resumenContenido").innerHTML = "Enviando datos...";

  // ================== ENVO A LOS 2 FORMS ==================
  await Promise.all([
    fetch("https://docs.google.com/forms/d/1Mlds1RQPtTiL2oqL0dtmKdilH2Y2X57KW1V3ADudOa8/formResponse", {
      method: "POST",
      mode: "no-cors",
      body: formData1
    }),
    fetch("https://docs.google.com/forms/u/0/d/e/1FAIpQLSdGn8cGGxPQ4n6U6VwusujgUADpLVk2tIpEe3se9cnZmP_TeQ/formResponse", {
      method: "POST",
      mode: "no-cors",
      body: formData2
    })
  ]);

  alert("Datos enviados correctamente");

  const rep = formData1.get("entry.223399256");

  this.reset();

  document.querySelector('select[name="entry.223399256"]').value = rep;

  cargarResumenRepresentante(rep);

}); 

  
// ===== Inicializar selects vac铆os al cargar =====
window.addEventListener("load", () => {
  setOptions(Contencion, []);
  setOptions(Visualizador, []);
  setOptions(Oferta_aplicada, []);
  setOptions(Observacion, []);
  setOptions(Realizaste_Cambio_de_Plan, []);
  setOptions(Motivo_no_oferta, []);
  setOptions(Producto, []);

 Resultado.dispatchEvent(new Event("change"));
  Visualizador.dispatchEvent(new Event("change"));
  Ofreciste.dispatchEvent(new Event("change"));
  
});


</script>

</body>
</html>














