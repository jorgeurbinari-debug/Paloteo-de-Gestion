<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Formulario Google</title>
</head>
<body>

<h2>Registro</h2>

<form id="googleForm">

  <!-- REPRESENTANTE -->
  <select name="entry.223399256" required>
    <option value="">Selecciona Representante</option>
    <option value="AGUILAR VARGAS URSULA NOEMI">AGUILAR VARGAS URSULA NOEMI</option>
    <option value="ALTAMIRANO MEGO MARIO SERGIO">ALTAMIRANO MEGO MARIO SERGIO</option>
    
  </select>

  <!-- TENENCIA -->
  <select id="Tenencia" name="entry.263067344" required>
    <option value="">Selecciona</option>
    <option value="Trio">Trio</option>
    <option value="Duo">Duo</option>
    <option value="Mono">Mono</option>
  </select>

  <input id="PP_Contenidos" name="entry.2021424275" placeholder="PP_Contenidos" required readonly>
  <input name="entry.528607190" placeholder="ANI" required>
  <input name="entry.938303002" placeholder="Suscripci贸n" required>

  <!-- RESULTADO -->
  <select id="Resultado" name="entry.308640399" required>
    <option value="">Selecciona</option>
    <option value="CONSULTA">CONSULTA</option>
    <option value="CONTENIDO">CONTENIDO</option>
    <option value="BAJA TOTAL">BAJA TOTAL</option>
    <option value="BAJA PARCIAL">BAJA PARCIAL</option>
  </select>

  <!-- SEGUNDO BLOQUE -->
  <hr>
  <input id="Contencion" name="entry.1265624613" placeholder="Contenci贸n" required readonly>

  <!-- Transferencia a isla de validacion -->
  <select id="Transferencia" name="entry.526710020" required>
    <option value="">Selecciona</option>
    <option value="Si">Si</option>
    <option value="No">No</option>
  </select>

  <input name="entry.1718642695" placeholder="Folio" required>
  <input id="Visualizador" name="entry.448110065" placeholder="Visualizador" required readonly> 
  <input id="Oferta_aplicada" name="entry.461946160" placeholder="Oferta_aplicada" required readonly>
  <input id="Observacion" name="entry.1321924343" placeholder="Observaci贸n" required readonly>
 
  <!-- TERCER BLOQUE -->
  <hr>
  <input id="RealizasteCambioDePlan" name="entry.1187965590" placeholder="Realizaste_Cambio_de_Plan"> 
  
  <!-- OFRECISTE -->
  <select id="Ofreciste" name="entry.435477933" required>
    <option value="">Selecciona</option>
    <option value="Si">Si</option>
    <option value="No">No</option>
    <option value="No Aplica">No Aplica</option>
  </select>

  <input id="MotivoNoOferta" name="entry.217503159" placeholder="Motivo_no_oferta"> 
  <input id="Producto" name="entry.795483787" placeholder="Producto"> 
  
  <!-- MOTIVO DE BAJA -->
  <select id="MotivoBaja" name="entry.960725776" required>
    <option value="">Selecciona</option>
    <option value="Competencia con mejor precio">Competencia con mejor precio</option>
    <option value="Falla masiva">Falla masiva</option>
    <!-- Resto de opciones omitidas -->
  </select>

  <!-- OFERTA MAXIMA -->
  <select id="OfertaMaxima" name="entry.1087208625" required>
    <option value="">Selecciona</option>
    <option value="Competencia con mejor precio">Competencia con mejor precio</option>
    <option value="OFERTA DEL 20">OFERTA DEL 20</option>
    <!-- Resto de ofertas omitidas -->
  </select>

  <br><br>
  <button type="submit">Enviar</button>
</form>

<!-- SCRIPTS -->
<script>
  //  ACTUALIZAR PP CONTENIDOS
  function actualizarPPContenidos() {
    const tenencia = document.getElementById("Tenencia").value;
    const resultado = document.getElementById("Resultado").value;
    const pp = document.getElementById("PP_Contenidos");

    if (!tenencia || !resultado) { pp.value = "0"; return; }

    if (resultado === "CONTENIDO") {
      pp.value = (tenencia === "Trio") ? "2" : "1";
    } else if (resultado === "BAJA PARCIAL") {
      pp.value = (tenencia === "Trio" || tenencia === "Duo") ? "1" : "0";
    } else {
      pp.value = "0";
    }
  }

  document.getElementById("Tenencia").addEventListener("change", actualizarPPContenidos);
  document.getElementById("Resultado").addEventListener("change", actualizarPPContenidos);

  //  VISUALIZADOR
  document.getElementById("Resultado").addEventListener("change", function() {
    const val = this.value.toUpperCase();
    const visualizador = document.getElementById("Visualizador");
    if (!visualizador) return;

    if (val === "CONSULTA" || val === "BAJA TOTAL") visualizador.value = "NO APLICA";
    else if (val === "CONTENIDO" || val === "BAJA PARCIAL") visualizador.value = "SI";
    else visualizador.value = "";
  });

  //  OFERTA APLICADA
  document.getElementById("Visualizador").addEventListener("change", function() {
    const val = this.value.toUpperCase();
    const oferta = document.getElementById("Oferta_aplicada");
    if (!oferta) return;

    if (val === "SI") oferta.value = "OFERTA 1";
    else if (val === "NO") oferta.value = "OFERTA NO ADHERIDA";
    else if (val === "ARGUMENTARIO") oferta.value = "Argumentario";
    else oferta.value = "";
  });

  //  OBSERVACION
  document.getElementById("Visualizador").addEventListener("change", function() {
    const val = this.value.toUpperCase();
    const obs = document.getElementById("Observacion");
    if (!obs) return;

    if (val === "OFERTA 1") obs.value = "CLIENTE CONFORME CON OFERTA DE VISUALIZADOR";
    else if (val === "ARGUMENTARIO") obs.value = "ARGUMENTARIO";
    else if (val === "OFERTA NO ADHERIDA") obs.value = "RETE - OFERTA NO SE ADAPTA A NECESIDAD DEL CLIENTE";
    else if (val === "NO APLICA") obs.value = "NO APLICA - SOLO CONSULTA";
    else obs.value = "";
  });

  //  CAMBIO DE PLAN
  document.getElementById("Resultado").addEventListener("change", function() {
    const val = this.value.toUpperCase();
    const plan = document.getElementById("RealizasteCambioDePlan");
    if (!plan) return;

    if (val === "BAJA TOTAL" || val === "CONSULTA") plan.value = "NO APLICA";
    else if (val === "CONTENIDO") plan.value = "MIGRA DOWN"; // l贸gica simplificada
    else if (val === "BAJA PARCIAL") plan.value = "BAJA PARCIAL";
    else plan.value = "";
  });

  //  MOTIVO NO OFERTA Y PRODUCTO
  document.getElementById("Ofreciste").addEventListener("change", function() {
    const val = this.value.toUpperCase();
    const motivo = document.getElementById("MotivoNoOferta");
    const producto = document.getElementById("Producto");

    if (!motivo || !producto) return;

    if (val === "NO" ) {
      motivo.value = "CLIENTE"; // ejemplo simplificado
      producto.value = "NO APLICA";
    } else if (val === "SI") {
      motivo.value = "NO APLICA";
      producto.value = "FIBRA";
    } else {
      motivo.value = "NO APLICA";
      producto.value = "NO APLICA";
    }
  });

  //  CONTENCION
  document.getElementById("Resultado").addEventListener("change", function() {
    const val = this.value.toUpperCase();
    const contencion = document.getElementById("Contencion");
    if (!contencion) return;

    if (val === "CONSULTA") contencion.value = "NO APLICA (Solo consultas)";
    else if (val === "CONTENIDO" || val === "BAJA PARCIAL") contencion.value = "SI";
    else if (val === "BAJA TOTAL") contencion.value = "NO";
    else contencion.value = "";
  });

  //  ENVIO FORMULARIO
  document.getElementById("googleForm").addEventListener("submit", function(e) {
    e.preventDefault();
    const formData = new FormData(this);
    fetch("https://docs.google.com/forms/d/1Mlds1RQPtTiL2oqL0dtmKdilH2Y2X57KW1V3ADudOa8/formResponse", {
      method: "POST",
      mode: "no-cors",
      body: formData
    });
    alert("Datos enviados correctamente");
    this.reset();
  });
</script>

</body>
</html>
