<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Formulario Google</title>
</head>
<body>

<h2>Registro</h2>

<form id="googleForm">

<!-- ================= REPRESENTANTE ================= -->
<select name="entry.223399256" required>
  <option value="">Selecciona Representante</option>
  <option value="AGUILAR VARGAS URSULA NOEMI">AGUILAR VARGAS URSULA NOEMI</option>
  <option value="ALTAMIRANO MEGO MARIO SERGIO">ALTAMIRANO MEGO MARIO SERGIO</option>
  <option value="ÑIQUEN ARROYO KATTIA LISET">ÑIQUEN ARROYO KATTIA LISET</option>
</select>

<hr>

<!-- ================= TENENCIA ================= -->
<select id="TenenciaPrincipal" name="entry.263067344" required>
  <option value="">Selecciona Tenencia</option>
  <option value="Trio">Trio</option>
  <option value="Duo">Duo</option>
  <option value="Mono">Mono</option>
</select>

<input id="PP_Contenidos" name="entry.2021424275" placeholder="PP Contenidos" readonly>
<input name="entry.528607190" placeholder="ANI" required>
<input name="entry.938303002" placeholder="Suscripción" required>

<hr>

<!-- ================= RESULTADO ================= -->
<select id="Resultado" name="entry.308640399" required>
  <option value="">Selecciona Resultado</option>
  <option value="CONSULTA">CONSULTA</option>
  <option value="CONTENIDO">CONTENIDO</option>
  <option value="BAJA TOTAL">BAJA TOTAL</option>
  <option value="BAJA PARCIAL">BAJA PARCIAL</option>
</select>

<select id="Contencion" name="entry.1265624613" required>
  <option value="">Contención</option>
  <option value="SI">SI</option>
  <option value="NO">NO</option>
  <option value="NO APLICA">NO APLICA</option>
</select>

<select id="Visualizador" name="entry.448110065" required>
  <option value="">Visualizador</option>
  <option value="SI">SI</option>
  <option value="NO">NO</option>
  <option value="ARGUMENTARIO">ARGUMENTARIO</option>
  <option value="NO APLICA">NO APLICA</option>
</select>

<select id="Oferta_aplicada" name="entry.461946160" required>
  <option value="">Oferta aplicada</option>
  <option value="OFERTA 1">OFERTA 1</option>
  <option value="OFERTA 2">OFERTA 2</option>
  <option value="OFERTA 3">OFERTA 3</option>
  <option value="OFERTA NO ADHERIDA">OFERTA NO ADHERIDA</option>
  <option value="ARGUMENTARIO">ARGUMENTARIO</option>
  <option value="NO APLICA">NO APLICA</option>
</select>

<select id="Observacion" name="entry.1321924343" required>
  <option value="">Observación</option>
  <option value="CLIENTE CONFORME">CLIENTE CONFORME</option>
  <option value="ARGUMENTARIO">ARGUMENTARIO</option>
  <option value="OFERTA NO SE ADAPTA">OFERTA NO SE ADAPTA</option>
  <option value="NO APLICA">NO APLICA</option>
</select>

<hr>

<!-- ================= CAMBIO PLAN ================= -->
<select id="RealizasteCambioPlan" name="entry.1187965590" required>
  <option value="">¿Cambio de plan?</option>
  <option value="MIGRA UP">MIGRA UP</option>
  <option value="MIGRA DOWN">MIGRA DOWN</option>
  <option value="BAJA PARCIAL">BAJA PARCIAL</option>
  <option value="NO APLICA">NO APLICA</option>
</select>

<select id="Ofreciste" name="entry.435477933" required>
  <option value="">¿Ofreciste?</option>
  <option value="SI">SI</option>
  <option value="NO">NO</option>
  <option value="NO APLICA">NO APLICA</option>
</select>

<select id="MotivoNoOferta" name="entry.217503159" required>
  <option value="">Motivo no oferta</option>
  <option value="CLIENTE">CLIENTE</option>
  <option value="VMO">VMO</option>
  <option value="EXPERIENCIA ANTERIOR">EXPERIENCIA ANTERIOR</option>
  <option value="NO APLICA">NO APLICA</option>
</select>

<select id="Producto" name="entry.795483787" required>
  <option value="">Producto</option>
  <option value="FIBRA">FIBRA</option>
  <option value="MOVIL">MOVIL</option>
  <option value="FIBRA + MOVIL">FIBRA + MOVIL</option>
  <option value="NO APLICA">NO APLICA</option>
</select>

<hr>

<!-- ================= OFERTA MAXIMA ================= -->
<select id="OfertaMaxima" name="entry.1087208625" required>
  <option value="">Oferta máxima</option>
  <option value="OFERTA 20">OFERTA 20</option>
  <option value="OFERTA 30">OFERTA 30</option>
  <option value="OFERTA 40">OFERTA 40</option>
  <option value="OFERTA 50">OFERTA 50</option>
  <option value="ARGUMENTARIO">ARGUMENTARIO</option>
  <option value="NO APLICA">NO APLICA</option>
</select>

<hr>

<button type="submit">Enviar</button>

</form>

<script>
// ================= PP CONTENIDOS =================
function actualizarPP() {
  const t = TenenciaPrincipal.value;
  const r = Resultado.value;
  PP_Contenidos.value = "0";

  if (r === "CONTENIDO") {
    PP_Contenidos.value = t === "Trio" ? "2" : t ? "1" : "0";
  }
  if (r === "BAJA PARCIAL" && (t === "Trio" || t === "Duo")) {
    PP_Contenidos.value = "1";
  }
}
TenenciaPrincipal.addEventListener("change", actualizarPP);
Resultado.addEventListener("change", actualizarPP);

// ================= RESULTADO =================
Resultado.addEventListener("change", () => {
  Contencion.value =
    Resultado.value === "CONSULTA" ? "NO APLICA" :
    Resultado.value === "BAJA TOTAL" ? "NO" : "SI";

  Visualizador.value =
    Resultado.value === "CONTENIDO" ? "SI" :
    Resultado.value === "BAJA PARCIAL" ? "ARGUMENTARIO" : "NO APLICA";

  RealizasteCambioPlan.value =
    Resultado.value === "CONTENIDO" ? "MIGRA UP" :
    Resultado.value === "BAJA PARCIAL" ? "BAJA PARCIAL" : "NO APLICA";
});

// ================= ENVIO =================
googleForm.addEventListener("submit", e => {
  e.preventDefault();
  fetch(
    "https://docs.google.com/forms/d/1Mlds1RQPtTiL2oqL0dtmKdilH2Y2X57KW1V3ADudOa8/formResponse",
    { method: "POST", mode: "no-cors", body: new FormData(googleForm) }
  );
  alert("Datos enviados correctamente");
  googleForm.reset();
});
</script>

</body>
</html>
