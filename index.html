<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Formulario Google</title>
  <style>
    select, input { margin: 5px 0; padding: 5px; width: 300px; }
    hr { margin: 15px 0; }
  </style>
</head>
<body>

<h2>Registro</h2>

<form id="googleForm">

  <!-- REPRESENTANTE -->
  <label for="representante">Representante:</label>
  <select name="entry.223399256" required>
    <option value="">Selecciona Representante</option>
    <option value="AGUILAR VARGAS URSULA NOEMI">AGUILAR VARGAS URSULA NOEMI</option>
    <option value="ALTAMIRANO MEGO MARIO SERGIO">ALTAMIRANO MEGO MARIO SERGIO</option>
    <option value="ARBOLEDA SERRATO MEDALITH DEL ROCIO">ARBOLEDA SERRATO MEDALITH DEL ROCIO</option>
    <!-- ...otros representantes... -->
    <option value="ﾃ選QUEN ARROYO KATTIA LISET">ﾃ選QUEN ARROYO KATTIA LISET</option>
  </select>

  <!-- TENENCIA -->
  <label for="tenencia">Tenencia:</label>
  <select id="Tenencia" name="entry.263067344" required>
    <option value="">Selecciona</option>
    <option value="Trio">Trio</option>
    <option value="Duo">Duo</option>
    <option value="Mono">Mono</option>
  </select>

  <input id="PP_Contenidos" name="entry.2021424275" placeholder="PP_Contenidos" required readonly>
  <input name="entry.528607190" placeholder="ANI" required>
  <input name="entry.938303002" placeholder="Suscripciﾃｳn" required>

  <!-- RESULTADO -->
  <label for="resultado">Resultado:</label>
  <select id="Resultado" name="entry.308640399" required>
    <option value="">Selecciona</option>
    <option value="CONSULTA">CONSULTA</option>
    <option value="CONTENIDO">CONTENIDO</option>
    <option value="BAJA TOTAL">BAJA TOTAL</option>
    <option value="BAJA PARCIAL">BAJA PARCIAL</option>
  </select>

  <hr>

  <!-- Contenciﾃｳn -->
  <label for="contencion">Contencion:</label>
  <select id="Contencion" name="entry.1265624613" required>
    <option value="">Selecciona</option>
  </select>

  <!-- Transferencia a isla de validaciﾃｳn -->
  <label for="transferenciaisla">Trans. Isla:</label>
  <select id="TenenciaValidacion" name="entry.526710020" required>
    <option value="">Selecciona</option>
    <option value="Si">Si</option>
    <option value="No">No</option>
  </select>

  <label for="folio">Folio:</label>
  <input name="entry.1718642695" placeholder="Folio" required>

  <!-- Visualizador -->
  <label for="Visualizador">Visualizador:</label>
  <select id="Visualizador" name="entry.448110065" required>
    <option value="">Selecciona</option>
  </select>

  <!-- Oferta aplicada -->
  <label for="ofertaaplicada">Oferta Aplicada:</label>
  <select id="Oferta_aplicada" name="entry.461946160" required>
    <option value="">Selecciona</option>
  </select>

  <!-- Observaciﾃｳn -->
  <label for="Observacion">Observacion de No adhiere:</label>
  <select id="Observacion" name="entry.1321924343" required>
    <option value="">Selecciona</option>
  </select>

  <hr>

  <!-- Realizaste cambio de plan -->
  <label for="migra">Migra:</label>
  <select id="Realizaste_Cambio_de_Plan" name="entry.1187965590" required>
    <option value="">Selecciona</option>
  </select>

  <!-- Ofreciste -->
  <label for="ofreciste">Ofreciste:</label>
  <select id="Ofreciste" name="entry.435477933" required>
    <option value="">Selecciona</option>
    <option value="SI">Si</option>
    <option value="NO">No</option>
    <option value="NO APLICA">No Aplica</option>
  </select>

  <!-- Motivo no oferta -->
  <label for="motivodenooferta">Movitivo de No Oferta:</label>
  <select id="Motivo_no_oferta" name="entry.217503159" required>
    <option value="">Selecciona</option>
  </select>

  <!-- Producto ofrecido -->
  <label for="ProductoOfrecido">Producto Ofrecido:</label>
  <select id="Producto" name="entry.795483787" required>
    <option value="">Selecciona</option>
  </select>

  <!-- Motivo de baja -->
  <label for="MotivoBaja">Motivo Baja:</label>
  <select id="Motivo_baja" name="entry.960725776" required>
    <option value="">Selecciona</option>
    <option value="Competencia con mejor precio">Competencia con mejor precio</option>
    <option value="Falla masiva">Falla masiva</option>
    <option value="Fallecimiento">Fallecimiento</option>
    <option value="Mala experiencia Tﾃｩcnica">Mala experiencia Tﾃｩcnica</option>
    <option value="No entrega informaciﾃｳn">No entrega informaciﾃｳn</option>
    <option value="No hay factibilidad">No hay factibilidad</option>
    <option value="No reconoce venta">No reconoce venta</option>
    <option value="Oferta no aplicada">Oferta no aplicada</option>
    <option value="Reclamo ajuste IPC">Reclamo ajuste IPC</option>
    <option value="Reclamos Facturaciﾃｳn">Reclamos Facturaciﾃｳn</option>
    <option value="Renovaciﾃｳn descuento">Renovaciﾃｳn descuento</option>
    <option value="Situacion econﾃｳmica">Situacion econﾃｳmica</option>
    <option value="Sustituye por producto Movistar">Sustituye por producto Movistar</option>
    <option value="Traslado">Traslado</option>
    <option value="NO APLICA">NO APLICA</option>
  </select>

  <!-- Oferta mﾃ｡xima -->
  <label for="ofertamaxima">Oferta Maxima:</label>
  <select id="Oferta_maxima" name="entry.1087208625" required>
    <option value="">Selecciona</option>
    <option value="Competencia con mejor precio">Competencia con mejor precio</option>
    <option value="OFERTA DEL 20">OFERTA DEL 20</option>
    <option value="OFERTA DEL 21">OFERTA DEL 21</option>
    <!-- ... hasta OFERTA DEL 50 ... -->
    <option value="ARGUMENTARIO">ARGUMENTARIO</option>
    <option value="NO APLICA">NO APLICA</option>
  </select>

  <br><br>
  <button type="submit">Enviar</button>
</form>

<script>
  // 沐ｹ Funciﾃｳn para actualizar opciones dinﾃ｡micas
  function setOptions(select, options) {
    select.innerHTML = "";
    const placeholder = document.createElement("option");
    placeholder.value = "";
    placeholder.textContent = "Selecciona";
    select.appendChild(placeholder);

    options.forEach(opt => {
      const option = document.createElement("option");
      option.value = opt;
      option.textContent = opt;
      select.appendChild(option);
    });
  }

  const Resultado = document.getElementById("Resultado");
  const Tenencia = document.getElementById("Tenencia");
  const PP_Contenidos = document.getElementById("PP_Contenidos");
  const Visualizador = document.getElementById("Visualizador");
  const Oferta_aplicada = document.getElementById("Oferta_aplicada");
  const Observacion = document.getElementById("Observacion");
  const Realizaste_Cambio_de_Plan = document.getElementById("Realizaste_Cambio_de_Plan");
  const Ofreciste = document.getElementById("Ofreciste");
  const Motivo_no_oferta = document.getElementById("Motivo_no_oferta");
  const Producto = document.getElementById("Producto");
  const Contencion = document.getElementById("Contencion");

  // 沐ｹ PP Contenidos
  function actualizarPPContenidos() {
    const t = Tenencia.value;
    const r = Resultado.value;
    if (!t || !r) { PP_Contenidos.value = "0"; return; }

    if (r === "CONTENIDO") {
      PP_Contenidos.value = (t === "Trio") ? "2" : "1";
    } else if (r === "BAJA PARCIAL") {
      PP_Contenidos.value = (t === "Trio" || t === "Duo") ? "1" : "0";
    } else PP_Contenidos.value = "0";
  }

  Tenencia.addEventListener("change", actualizarPPContenidos);
  Resultado.addEventListener("change", actualizarPPContenidos);

  // 沐ｹ Visualizador y Contenciﾃｳn segﾃｺn Resultado
  Resultado.addEventListener("change", function() {
    const val = this.value.toUpperCase();

    // Visualizador
    if (["CONSULTA","BAJA TOTAL"].includes(val)) setOptions(Visualizador, ["NO APLICA"]);
    else if (["CONTENIDO","BAJA PARCIAL"].includes(val)) setOptions(Visualizador, ["SI","NO","Argumentario"]);
    else setOptions(Visualizador, []);

    // Contenciﾃｳn
    if (val === "CONSULTA") setOptions(Contencion, ["NO APLICA (Solo consultas)"]);
    else if (["CONTENIDO","BAJA PARCIAL"].includes(val)) setOptions(Contencion, ["SI"]);
    else if (val === "BAJA TOTAL") setOptions(Contencion, ["NO"]);
    else setOptions(Contencion, []);

    // Cambio de plan
    if (["BAJA TOTAL","CONSULTA"].includes(val)) setOptions(Realizaste_Cambio_de_Plan, ["NO APLICA"]);
    else if (val === "CONTENIDO") setOptions(Realizaste_Cambio_de_Plan, ["MIGRA DOWN","MIGRA UP","NO APLICA"]);
    else if (val === "BAJA PARCIAL") setOptions(Realizaste_Cambio_de_Plan, ["BAJA PARCIAL"]);
    else setOptions(Realizaste_Cambio_de_Plan, []);
  });

  // 沐ｹ Oferta aplicada segﾃｺn Visualizador
  Visualizador.addEventListener("change", function() {
    const val = this.value.toUpperCase();
    if (val === "SI") setOptions(Oferta_aplicada, ["OFERTA 1","OFERTA 2","OFERTA 3"]);
    else if (val === "NO") setOptions(Oferta_aplicada, ["OFERTA NO ADHERIDA"]);
    else if (val === "ARGUMENTARIO") setOptions(Oferta_aplicada, ["ARGUMENTARIO"]);
    else if (val === "BAJA TOTAL") setOptions(Oferta_aplicada, ["NO APLICA"]);
    else setOptions(Oferta_aplicada, []);
  });

  // 沐ｹ Observaciﾃｳn segﾃｺn Oferta aplicada
  Oferta_aplicada.addEventListener("change", function() {
    const val = this.value.toUpperCase();
    if (["OFERTA 1","OFERTA 2","OFERTA 3"].includes(val)) setOptions(Observacion, ["CLIENTE CONFORME CON OFERTA DE VISUALIZADOR"]);
    else if (val === "ARGUMENTARIO") setOptions(Observacion, ["ARGUMENTARIO"]);
    else if (["OFERTA NO ADHERIDA","NO APLICA BT"].includes(val)) setOptions(Observacion, [
      "RETE - OFERTA NO SE ADAPTA A NECESIDAD DEL CLIENTE",
      "N2 - OFERTA NO SE ADAPTA A NECESIDAD DEL CLIENTE",
      "SOLICITA LA OFERTA MAS AGRESIVA",
      "OFERTADOR NO ARROJA OPCIONES"
    ]);
    else if (val === "NO APLICA") setOptions(Observacion, ["NO APLICA - SOLO CONSULTA"]);
    else setOptions(Observacion, []);
  });

  // 沐ｹ Motivo no oferta y Producto segﾃｺn Ofreciste
  Ofreciste.addEventListener("change", function() {
    const val = this.value.toUpperCase();
    if (val === "SI") {
      setOptions(Motivo_no_oferta, ["FIBRA","ALTA Mﾃ天IL","PORTABILIDAD Mﾃ天IL","FIBRA + Mﾃ天IL","RECAMBIO","FIBRA + RECAMBIO","MOVIL + RECAMBIO"]);
      setOptions(Producto, ["FIBRA","ALTA Mﾃ天IL","PORTABILIDAD Mﾃ天IL","FIBRA + Mﾃ天IL","RECAMBIO","FIBRA + RECAMBIO","MOVIL + RECAMBIO"]);
    } else if (val === "NO") {
      setOptions(Motivo_no_oferta, ["CLIENTE","VMO","EXPERIENCIA ANTERIOR"]);
      setOptions(Producto, ["NO APLICA"]);
    } else if (val === "NO APLICA") {
      setOptions(Motivo_no_oferta, ["NO APLICA"]);
      setOptions(Producto, ["NO APLICA"]);
    } else {
      setOptions(Motivo_no_oferta, []);
      setOptions(Producto, []);
    }
  });

  // 沐ｹ Envﾃｭo de formulario
  document.getElementById("googleForm").addEventListener("submit", function(e) {
    e.preventDefault();
    const formData = new FormData(this);
    fetch("https://docs.google.com/forms/d/1Mlds1RQPtTiL2oqL0dtmKdilH2Y2X57KW1V3ADudOa8/formResponse", {
      method: "POST",
      mode: "no-cors",
      body: formData
    });
    alert("Datos enviados correctamente");
    this.reset();
  });
</script>

</body>
</html>
