<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Formulario Google</title>
</head>
<body>

<h2>Registro</h2>

<form id="googleForm">

  <!-- REPRESENTANTE -->
  <select name="entry.223399256" required>
    <option value="">Selecciona Representante</option>
    <option value="AGUILAR VARGAS URSULA NOEMI">AGUILAR VARGAS URSULA NOEMI</option>
    <option value="ALTAMIRANO MEGO MARIO SERGIO">ALTAMIRANO MEGO MARIO SERGIO</option>
    <option value="ARBOLEDA SERRATO MEDALITH DEL ROCIO">ARBOLEDA SERRATO MEDALITH DEL ROCIO</option>
    <option value="BALAREZO CASTILLO KEYLA KATHERINE">BALAREZO CASTILLO KEYLA KATHERINE</option>
    <option value="BALLENA FERRE SARA FABIOLA">BALLENA FERRE SARA FABIOLA</option>
    <option value="BECERRA GOMEZ PACO JHORDAN">BECERRA GOMEZ PACO JHORDAN</option>
    <option value="BERRU MENDOZA MARIA ELIZABETH">BERRU MENDOZA MARIA ELIZABETH</option>
    <option value="CARRANZA CHAVESTA JOSE ROMY">CARRANZA CHAVESTA JOSE ROMY</option>
    <option value="CHUNG ESPEJO JUAN FRANCISCO">CHUNG ESPEJO JUAN FRANCISCO</option>
    <option value="CHUNGA PIZARRO MARGARETH ESTEFANI">CHUNGA PIZARRO MARGARETH ESTEFANI</option>
    <option value="CRISANTO GARRIDO DEYSI MARIBEL">CRISANTO GARRIDO DEYSI MARIBEL</option>
    <option value="CRISANTO LARTIGA MARIA VANESSA">CRISANTO LARTIGA MARIA VANESSA</option>
    <option value="DELGADO FARRO MITZY YOSHELY">DELGADO FARRO MITZY YOSHELY</option>
    <option value="DIAZ ACUÑA PAOLA STEFANIE">DIAZ ACUÑA PAOLA STEFANIE</option>
    <option value="DIAZ QUIROZ JOSE GALENO">DIAZ QUIROZ JOSE GALENO</option>
    <option value="ESPINOZA SILVA KIMBERLY YAMILE">ESPINOZA SILVA KIMBERLY YAMILE</option>
    <option value="FLORES NAVAL JUANA DEL PILAR">FLORES NAVAL JUANA DEL PILAR</option>
    <option value="GORDILLO YAIPEN EDITH MADELEI">GORDILLO YAIPEN EDITH MADELEI</option>
    <option value="GONZALES SAENZ EDGARDO DAVID">GONZALES SAENZ EDGARDO DAVID</option>
    <option value="GUTIERREZ MENDOZA TERESA OCDULIA">GUTIERREZ MENDOZA TERESA OCDULIA</option>
    <option value="HORNA CARRERO LILIANA">HORNA CARRERO LILIANA</option>
    <option value="LARIOS FIESTAS YESENIA PAOLA">LARIOS FIESTAS YESENIA PAOLA</option>
    <option value="LUCERO COTRINA JAIME ENRIQUE">LUCERO COTRINA JAIME ENRIQUE</option>
    <option value="LUNA TERRONES MIRIAN ROCIO">LUNA TERRONES MIRIAN ROCIO</option>
    <option value="MANAYAY ABAZALO BEVERLY BEATRIZ">MANAYAY ABAZALO BEVERLY BEATRIZ</option>
    <option value="MASABEL RIVAS GUILLERMINA DEL ROSARIO">MASABEL RIVAS GUILLERMINA DEL ROSARIO</option>
    <option value="MELENDEZ DEL CASTILLO FERNANDO GABRIEL">MELENDEZ DEL CASTILLO FERNANDO GABRIEL</option>
    <option value="ORTIZ SALAZAR ANABELEN">ORTIZ SALAZAR ANABELEN</option>
    <option value="PEREZ BANCES EDUARDO XKANLEONX ROLANDO">PEREZ BANCES EDUARDO XKANLEONX ROLANDO</option>
    <option value="PEREZ GONZALES KATHERINE YESSENIA">PEREZ GONZALES KATHERINE YESSENIA</option>
    <option value="RIOJAS TERRONES ANGELLA LIZETH">RIOJAS TERRONES ANGELLA LIZETH</option>
    <option value="RIVERA MERA JESSICA KARINA">RIVERA MERA JESSICA KARINA</option>
    <option value="SALAZAR VASQUEZ ANTONI MIGUEL">SALAZAR VASQUEZ ANTONI MIGUEL</option>
    <option value="SANCHEZ VILLAFRANQUI STEPHANO MIGUEL">SANCHEZ VILLAFRANQUI STEPHANO MIGUEL</option>
    <option value="SIRLUPU YOVERA AMALIA MARGOT">SIRLUPU YOVERA AMALIA MARGOT</option>
    <option value="SOTELO CHUMBE ABENCIA">SOTELO CHUMBE ABENCIA</option>
    <option value="TORRES OLANO PIERO ALEJANDRO">TORRES OLANO PIERO ALEJANDRO</option>
    <option value="TRIGOSO AYALA LISET MABEL">TRIGOSO AYALA LISET MABEL</option>
    <option value="UGAZ SAAVEDRA TIFFANY BRICET">UGAZ SAAVEDRA TIFFANY BRICET</option>
    <option value="VALDERRAMA CAJO FABIOLA KATHERINE MILAGROS DEL SOL">VALDERRAMA CAJO FABIOLA KATHERINE MILAGROS DEL SOL</option>
    <option value="VELASQUEZ SENMACHE MIGUEL ANGEL">VELASQUEZ SENMACHE MIGUEL ANGEL</option>
    <option value="VELASQUEZ FRIAS LIZBETH KARELLY">VELASQUEZ FRIAS LIZBETH KARELLY</option>
    <option value="VELIZ CHOQUE JANETH JHOSELIE">VELIZ CHOQUE JANETH JHOSELIE</option>
    <option value="ÑIQUEN ARROYO KATTIA LISET">ÑIQUEN ARROYO KATTIA LISET</option>
  </select>

  <!-- TENENCIA -->
  <select id="Tenencia" name="entry.263067344" required>
    <option value="">Selecciona</option>
    <option value="Trio">Trio</option>
    <option value="Duo">Duo</option>
    <option value="Mono">Mono</option>
  </select>

  <input name="entry.2021424275" placeholder="PP Contenidos" required>
  <input name="entry.528607190" placeholder="ANI" required>
  <input name="entry.938303002" placeholder="Suscripción" required>

  <!-- RESULTADO -->
  <select id="Resultado" name="entry.308640399" required>
    <option value="">Selecciona</option>
    <option value="CONSULTA">CONSULTA</option>
    <option value="CONTENIDO">CONTENIDO</option>
    <option value="BAJA TOTAL">BAJA TOTAL</option>
    <option value="BAJA PARCIAL">BAJA PARCIAL</option>
  </select>

  <!-- SEGUNDO BLOQUE -->
  <hr>
  <input id="Contencion" name="entry.1265624613" placeholder="Contención" required readonly>

    <!-- Transferencia a isla de validacion -->
  <select id="Tenencia" name="entry.526710020" required>
    <option value="">Selecciona</option>
    <option value="Si">Si</option>
    <option value="No">No</option>
  </select>
<input id="PPContenidos" name="entry.2021424275" placeholder="PP Contenidos" required>
  
  <input name="entry.1718642695" placeholder="Folio" required>
  <input name="entry.448110065" placeholder="Visualizador" required>
  <input name="entry.461946160" placeholder="Oferta_aplicada" required>
  <input name="entry.1321924343" placeholder="Observación">

  <hr>
  <input name="entry.1187965590" placeholder="Realizaste-Cambio-de-Plan" required> 
  
  <!-- OFRECISTE -->
  <select id="Tenencia" name="entry.435477933" required>
    <option value="">Selecciona</option>
    <option value="Si">Si</option>
    <option value="No">No</option>
    <option value="No Aplica">No</option>
  </select>

  
  <input id="motivoInput" name="entry.217503159" placeholder="Motivo no oferta"> 
  <input name="entry.795483787" placeholder="Producto" required> 
  <input name="entry.960725776" placeholder="Transferencia" required> 
  <input name="entry.1087208625" placeholder="Oferta máxima" required>

  <br><br>
  <button type="submit">Enviar</button>

   <!-- PP CONTENIDOS -->

<script>
  // Función para actualizar PP Contenidos
  function actualizarPPContenidos() {
    const tenencia = document.getElementById("Tenencia").value.toLowerCase();
    const resultado = document.getElementById("Resultado").value.toUpperCase();
    const pp = document.getElementById("PPContenidos");

    if (!pp) return;

    if (resultado === "CONTENIDO") {
      if (tenencia === "trio") {
        pp.value = "2";
      } else if (tenencia === "duo" || tenencia === "mono") {
        pp.value = "1";
      }
    } else if (resultado === "BAJA PARCIAL") {
      if (tenencia === "trio" || tenencia === "duo") {
        pp.value = "1";
      } else {
        pp.value = "0";
      }
    } else {
      pp.value = "0";
    }
  }

  // Escuchadores de cambio
  document.getElementById("Tenencia").addEventListener("change", actualizarPPContenidos);
  document.getElementById("Resultado").addEventListener("change", actualizarPPContenidos);
</script>

 <!-- ADHIERE VISUALIZADOR -->
  
  <script>
   // LOGICA DE CONTENCION SEGUN RESULTADO para campo contenido
  document.getElementById("Resultado").addEventListener("change", function() {
    const val = this.value.toUpperCase();
    const Visualizador = document.getElementById("Contencion");

    if (!Visualizador) return; // Seguridad: si no existe, salir

    if (val === "CONSULTA" ||val === "BAJA TOTAL") {
      Visualizador.value = "NO APLICA";
    } else if (val === "CONTENIDO" || val === "BAJA PARCIAL") {
      Visualizador.value = "SI";
      Visualizador.value = "NO";
      Visualizador.value = "Argumentario";
      } else {
      Visualizador.value = "";
    }
  });
</script>
  
 <!-- OFERTA APLICADA -->
  
  <script>
   // LOGICA DE CONTENCION SEGUN RESULTADO para campo contenido
  document.getElementById("Visualizador").addEventListener("change", function() {
    const val = this.value.toUpperCase();
    const Oferta_aplicada = document.getElementById("Contencion");

    if (!Oferta_aplicada) return; // Seguridad: si no existe, salir

    if (val === "SI") {
      Oferta_aplicada.value = "OFERTA 1";
      Oferta_aplicada.value = "OFERTA 2";
      Oferta_aplicada.value = "OFERTA 3";
    } else if (val === "NO" ) {
      Oferta_aplicada.value = "OFERTA NO ADHERIDA";
    } else if (val === "Argumentario" ) {
      Oferta_aplicada.value = "Argumentario";      
    } else if (val === "BAJA TOTAL" ) {
      Oferta_aplicada.value = "NO APLICA";
    } else {
      Oferta_aplicada.value = "";
    }
  });
</script>

  
   <!-- OBSERVACION DE NO ADHERIRSE -->
  
  <script>
   // LOGICA DE CONTENCION SEGUN RESULTADO para campo contenido
  document.getElementById("Visualizador").addEventListener("change", function() {
    const val = this.value.toUpperCase();
    const Observación = document.getElementById("Contencion");

    if (!Observación) return; // Seguridad: si no existe, salir

    if (val === "OFERTA 1" ||val === "OFERTA 2"  ||val === "OFERTA 3") {
      Observación.value = "CLIENTE CONFORME CON OFERTA DE VISUALIZADOR";
    } else if (val === "ARGUMENTARIO" ) {
      Observación.value = "ARGUMENTARIO";
    } else if (val === "OFERTA NO ADHERIDA") {
      Observación.value = "RETE - OFERTA NO SE ADAPTA A NECESIDAD DEL CLIENTE";
      Observación.value = "N2 - OFERTA NO SE ADAPTA A NECESIDAD DEL CLIENTE";
      Observación.value = "SOLICITA LA OFERTA MAS AGRESIVA";
      Observación.value = "OFERTADOR NO ARROJA OPCIONES";
    } else if (val === "NO APLICA BT") {
      Observación.value = "RETE - OFERTA NO SE ADAPTA A NECESIDAD DEL CLIENTE";
      Observación.value = "N2 - OFERTA NO SE ADAPTA A NECESIDAD DEL CLIENTE";
      Observación.value = "SOLICITA LA OFERTA MAS AGRESIVA";
      Observación.value = "OFERTADOR NO ARROJA OPCIONES";
    } else if (val === "NO APLICA" ) {
      Observación.value = "NO APLICA - SOLO CONSULTA";
    } else {
      Observación.value = "";
    }
  });
</script>

 <!-- MIGRACIOMN DE CAMBIO DE PLAN -->
  
  <script>
   // LOGICA DE CONTENCION SEGUN RESULTADO para campo contenido
  document.getElementById("Resultado").addEventListener("change", function() {
    const val = this.value.toUpperCase();
    const Realizaste-Cambio-de-Plan = document.getElementById("Contencion");

    if (!Realizaste-Cambio-de-Plan) return; // Seguridad: si no existe, salir

    if (val === "BAJA TOTAL" ||val === "CONSULTA" ) {
      Realizaste-Cambio-de-Plan.value = "NO APLICA";
    } else if (val === "CONTENIDO" ) {
      Realizaste-Cambio-de-Plan.value = "MIGRA DOWN";
      Realizaste-Cambio-de-Plan.value = "MIGRA UP";
      Realizaste-Cambio-de-Plan.value = "NO APLICA";
    } else if (val === "BAJA PARCIAL") {
      Realizaste-Cambio-de-Plan.value = "BAJA PARCIAL";
    } else {
      Realizaste-Cambio-de-Plan.value = "";
    }
  });
</script>
  
  
   <!-- TENENCIA -->

</form>

<script>
   // LOGICA DE CONTENCION SEGUN RESULTADO para campo contenido
  document.getElementById("Resultado").addEventListener("change", function() {
    const val = this.value.toUpperCase();
    const contencion = document.getElementById("Contencion");

    if (!contencion) return; // Seguridad: si no existe, salir

    if (val === "CONSULTA") {
      contencion.value = "NO APLICA (Solo consultas)";
    } else if (val === "CONTENIDO" || val === "BAJA PARCIAL") {
      contencion.value = "SI";
    } else if (val === "BAJA TOTAL") {
      contencion.value = "NO";
    } else {
      contencion.value = "";
    }
  });



  // ENVIO FORMULARIO
  document.getElementById("googleForm").addEventListener("submit", function(e) {
    e.preventDefault(); 
    const formData = new FormData(this); 
    fetch("https://docs.google.com/forms/d/1Mlds1RQPtTiL2oqL0dtmKdilH2Y2X57KW1V3ADudOa8/formResponse",
      { method: "POST", mode: "no-cors", body: formData }
    ); 
    alert("Datos enviados correctamente"); 
    this.reset(); 
  }); 
</script>

</body> 
</html>




